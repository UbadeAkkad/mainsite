{% extends 'home/main.html' %}
{% block content %}
<h2>Todo List</h2>
<form method="GET" class="row g-3">
    <div class="col-md-2 grid-col">
        <input type="text" class="form-control" placeholder="Search" name="search_query" value="{{search_input}}">
    </div>
    <div class="col-md-4 grid-col">
        <input type="submit" class="btn btn-primary" value="Search">
        {% if search_input == "" %}
        <input type="reset" value="Clear" class="btn btn-primary">
        {% else %}
        <a href="{% url 'todo' %}" class="btn btn-primary">Clear</a>
        {% endif %}
        <a href="{% url 'createtask' %}" class="btn btn-primary">Add New Task</a>
    </div>
</form>
    <br>
    <div class="accordion accordion-flush" id="accordionFlush">
    {% for task in tasks %}
    {% with task.id|stringformat:"s" as flush_id %}
    <div class="accordion-item">
        <h2 class="accordion-header">
        {% if task.complete %}
          <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="{{'#flush-collapse'|add:flush_id}}">
            <s>{{task.title}}</s>
          </button>
        {% else %}
        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="{{'#flush-collapse'|add:flush_id}}">
            {{task.title}}
          </button>
        {% endif %}
        </h2>
        <div id="{{'flush-collapse'|add:flush_id}}" class="accordion-collapse collapse" data-bs-parent="#accordionFlush">
          <div class="accordion-body">{{task.description}}</div>
          <div class="row">
            <div class="col-md-1 offset-md-11">
                <a href="{% url 'edittask' task.id %}"><span class="material-symbols-outlined">edit</span></a>
                <a href="{% url 'deletetask' task.id %}"><span class="material-symbols-outlined">delete</span></a>
                <br>
            </div>  
        </div>
      </div>
      <br>
      {% endwith %}
    {% empty %}
        <p>Your todo list is empty.</p>
    {% endfor %}
</div>
{% endblock content %}